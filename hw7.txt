COMMENT = "Опечатка в сорздании таблицы products(desription)"
INSERT INTO orders (user_id) VALUES (1), (1), (2), (1), (2);
INSERT INTO orders_products (order_id, product_id, total) VALUES (1, 1, 3), (1, 4, 3), (1, 5, 3), (2, 4, 1), (3, 3, 1), (4, 5, 2), (4, 1, 2), (5, 3, 1);

1)SELECT DISTINCT users.id, users.name FROM users INNER JOIN orders ON users.id = orders.user_id;

2)SELECT products.name AS product_name, catalogs.name AS catalog_name, users.name AS user_name
	FROM users 
	INNER JOIN orders 
	INNER JOIN orders_products 
	INNER JOIN products
	INNER JOIN catalogs
	ON users.id = orders.user_id
	AND orders_products.order_id = orders.id
	AND orders_products.product_id = products.id
	AND products.catalog_id = catalogs.id
	WHERE orders.ID = 1;

3)CREATE TABLE flights (
  id SERIAL PRIMARY KEY,
  `from` VARCHAR(255),
  `to` VARCHAR(255)
);

INSERT INTO flights (`from`, `to`) VALUES
  ('moscow', 'omsk'),
  ('novgorod', 'kazan'),
  ('irkutsk', 'moscow'),
  ('omsk', 'irkutsk'),
  ('moscow', 'kazan');

CREATE TABLE cities (
  id SERIAL PRIMARY KEY,
  label VARCHAR(255),
  name VARCHAR(255)
);

INSERT INTO cities (label, name) VALUES
  ('moscow', 'Москва'),
  ('novgorod', 'Новгород'),
  ('irkutsk', 'Иркутск'),
  ('kazan', 'Казань'),
  ('omsk', 'Омск');

SELECT cities_from.name, cities_to.name 
	FROM flights
	INNER JOIN cities as cities_from  
	LEFT JOIN cities as cities_to 
	ON flights.`to` = cities_to.label
	AND flights.`from` = cities_from.label
	WHERE cities_to.name IS NOT NULL; 